\include{./../latex/notes_style.tex}
%--------------------------------------------------------------------------------------------------------------------------------


\title{Exercise set 4}




\begin{document}

\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  EXERCISES  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%






 % ------------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Bias and consistency]\label{ex:1}
Let
\begin{equation*}
X \sim {\rm Bernoulli}(q)
\end{equation*}
and $X_1,\dots,X_N$ denote $N$ samples of $X$. 
For each of the following estimators of $q$, (i) write down the standard error and (ii) state whether they are un-biased and/or consistent. (In each case, you can write down an exact formula for the standard error, so you do NOT need to use the CLT.)
\begin{enumerate}[label=(\alph*)]
\item 
\begin{equation*}
\hat{q}_{0} = \frac{1}{N}\sum_{i=1}^NX_i
\end{equation*}
\item 
\begin{equation*}
\hat{q}_{1} = \frac{Y}{N} + \frac{1}{\sqrt{N}},\quad Y = \sum_{i=1}^NX_i
\end{equation*}
\item 
\begin{equation*}
\hat{q}_{2} = \frac{1}{\lfloor N/2 \rfloor}\sum_{i=1}^{\lfloor N/2 \rfloor}X_i
\end{equation*}
The notation $\lfloor  n \rfloor$ means the floor; that is, the largest integer less than $n$. For example, $\lfloor 101/2 \rfloor = \lfloor 50.5 \rfloor = 50$. 
\end{enumerate}

\end{exercise}




 % ------------------------------------------------------------------------------------------------------------------------------------------

 % ------------------------------------------------------------------------------------------------------------------------------------------
%\begin{exercise}{\bf bias}
%Let $q$ be the parameter of a Bernoulli random variable. Let $\hat{q}$, $\hat{q}_1$ and $\hat{q}_2$ be two other estimators of $q$ defined by \begin{align}
%\hat{q} &= \frac{Y}{N}\\
%\hat{q}_{1} &= \frac{Y}{N} + \frac{1}{N}\\
%\hat{q}_{2} &= \frac{y_1 + y_2}{2}
%\end{align}
%\begin{enumerate}
%\item What are the sample distributions of these? 
%\item Are they consistent?
%\item Are they biased?
%\item Confirm your answers with simulations. 
%\end{enumerate}
%%Are $\hat{q}_1$ and $\hat{q}_2$ biased or not? Try to answer the question based solely on the definitions and generate simulations and make a plot (or multiple plots) to support your result. {\emph Hint:} Think about what the sample distribution of these estimators are.
%\end{exercise}


 % ------------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Estimator of mean in exponential model]
Let
\begin{equation*}
T \sim {\rm Exponential}(\lambda). 
\end{equation*}
Recall that $E[T] = 1/\lambda$. We can estimate $E[T]$ via the sample average of measurements $T_1,\dots,T_n$, 
\begin{equation*}
E[T] \approx \overline{T} = \frac{1}{n}\sum_{i=1}^nT_i.
\end{equation*}
This suggests that a natural way to estimate $\lambda$ is by 
\begin{equation*}
\hat{\lambda} = \frac{1}{\overline{T}} = \frac{1}{ \frac{1}{n}\sum_{i=1}^nT_i}. 
\end{equation*}
\begin{enumerate}[label=(\alph*)]
\item  The goal of the first part of this problem is to show, using simulations, that this is in-fact a biased estimator of $\lambda$, although the bias decreases with $n$. 
To achieve this, you should do the following: 
\begin{itemize}
\item Make a list of 100 values of $\lambda$. You could use any range, but I picked between $0.2$ and $2$. 
\item For each value of $\lambda$, 
\begin{itemize}
\item simulate $10000$ replicates of an experiment, where each replicate includes $n=5$ values of $T$. 
\item For each of these replicates, compute $\hat{\lambda}$ as defined above. 
\item Then estimate the average $E[\hat{\lambda}]$ and save this value in a list. 
\end{itemize}
\item Make a plot of $\lambda$ vs. $\left|E[\hat{\lambda}]-\lambda\right|$. 
\end{itemize}
\item ({\bf optional -- ungraded}) Consider the case $n=2$. Prove that 
\begin{equation*}
E[\hat{\lambda}] = E\left[\frac{1}{\overline{T}}\right]  \ge \lambda 
\end{equation*}
This is a special case of Jenson's inequality. 
\end{enumerate}


%Consider the non-linear model
%\begin{align}
%Y &= X^2 + \epsilon \\
%X &\sim {\rm Normal}(0,1)\\
%\epsilon &\sim {\rm Normal}(0,\sigma_{\epsilon})
%\end{align}
%\begin{enumerate}
%\item Is the distribution of $Y$ Normal? You do not need to determine what the distribution is to answer this. 
%\item What about the distribution of $Y|(X=x)$? 
%\item What about the covariance?
%\end{enumerate}
\end{exercise}





 % ------------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Earnings data] Consider the earnings data. This can be loaded with 
\begin{Verbatim}
df = pd.read_csv("https://raw.githubusercontent.com/avehtari
/ROS-Examples/master/Earnings/data/earnings.csv")
\end{Verbatim}
In this exercises, you will study the association between earnings and gender. In particular, you will explore how this depends on height. Later we will see there is a better way to answer this question by performing a regression with multiple predictors, but taking this more elementary approach will elucidate some key aspects of regression analysis. 
\begin{enumerate}[label=(\alph*)]
\item What do you expect the association between gender and earnings to be? Where do you expectations come from (news, intuition, other courses you've taken)? 
\item Using stats models, perform a linear regression on with gender (the column ``male'') as the predictor and earnings as the response variable. You can either use ``earnk'' or ``earn'', just keep track of the units.  Then answer the questions 
\begin{itemize}
\item Is there a statistically significant effect? 
\item Is the direction and size of the effect what you expected? 
\end{itemize}
\item  Using stats models, perform a linear regression with height as the predictor and earnings as the response variable. Answer the same questions which are posed in part (a). 
\item You should have found there is an association between both gender and earnings, as well as height and earnings. 
 A natural question is whether the association between height and earnings is simply a byproduct of the fact that men are taller on average.  To answer this question, separate the data into males and females, then fit the linear regression model with height as a predictor separately for each group. 
 \item Based on the results from the previous problem, what do you conclude? Is the association between height and earnings solely due to the association between gender and heights? Do you think it is partially due to the height? 
\end{enumerate}
\end{exercise}

 % ------------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Quiz practice]
Answer the questions on the practice quiz. You are welcome to provide some feedback on the quiz regarding difficultly level, clarity of problems, relevance to course material etc. 
\end{exercise}



 % ------------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Statistical significance -- {\bf optional challenge}]
Show (using math OR simulations) that it is possible to conduct two experiments (let's use clinical trials as an example) so that $\Delta \hat{\mu}$ (using the same notation as my notes) is statistically significant for one experiment and not the other, yet the difference between $\Delta \hat{\mu}$ between the two experiments is not statistically significant.  Here, by statistically significant I mean the $p$-value is $<0.05$. 
\end{exercise}






\end{document}