\include{./../latex/notes_style.tex}
%--------------------------------------------------------------------------------------------------------------------------------
\begin{document}


\title{Exercise set 1}

\maketitle






\section{Exercises}


%--------------------------------------------------------------------------------------------------------------------------------



%--------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Working with probability distributions and modeling]
The first two problems are inspired by those in section 2 of \cite{tabak}.   You should look there for more practice. 
\begin{enumerate}[label=(\alph*)]
\item Suppose that 
\begin{equation*}
Y \sim {\rm Bernoulli}(q)
\end{equation*}
and let $Z = 1/(1+Y) + Y$. What is the sample space of $Z$ and what is the probability function of $Z$? You can either write the probability distribution as a piecewise function as I did for the Bernoulli distribution in class, or specify each value e.g. $P(Z=z) = \cdots$.
\item Suppose a coin is flipped. If the coin is heads, we write down $0$. If the coin is tails, we roll a dice and write down the number. What is the sample space and the probability distribution for $Y$, the number that we write down. 
\item For the previous problem, conditioned on the dice rolling a $4$, what is the probability we write down $0$? Conditioned on the coin being tails, what is the probability the dice rolls a $3$?
\item Consider the geometric distribution discussed in lecture. What are 3 examples of variables in the real world for which this might be a good model and what are some limitations of these models. 
\end{enumerate}
\end{exercise}




%--------------------------------------------------------------------------------------------------------------------------------
 \begin{exercise}[Working with nested for loops]
 
 

Consider the following code:

\begin{Verbatim}
for i in range(5):
  for j in range(i+1):
    print(i,end='')
  print("")
\end{Verbatim}
prints out
\begin{Verbatim}
0
11
222
3333
44444
\end{Verbatim}
Modify this code to print
\begin{Verbatim}
0
01
012
0123
01234
012345
\end{Verbatim}
\end{exercise}



 
%--------------------------------------------------------------------------------------------------------------------------------
% \begin{exercise}[Working with housing data] 
% This problem is based on Ch. 2 Ex. 10 in \cite{islp}. Use the following code to load data on housing Boston from \cite{islp}. The data is described \href{https://islp.readthedocs.io/en/latest/datasets/Boston.html}{here}.
% \begin{Verbatim}
%Boston = pd.read_csv("https://raw.githubusercontent.com
%/intro-stat-learning/ISLP/main/ISLP/data/Boston.csv")
%\end{Verbatim}
%\begin{enumerate}[label=(\alph*)]
%\item How many rows are in this data set? How many columns? What do the rows and columns represent?
%%\item  Make pairwise scatterplots of the 
%%\item Are any of the predictors associated with per capita crime rate? If so, explain the relationship.
%\item How many of the suburbs in this data set bound the Charles river?
%\end{enumerate}
% \end{exercise}
 
%--------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Washington post data]\label{ex:washpost}
Below I load some data on homocide victims in US from the washington post. Don't worry about how I process it, all you need to work with is the DataFrame ``data`` on the very last line.
%(When I first tried to run this line of code I got an error about the encoding
%a quick google search led to a post which suggested I should add the line 
% "encoding = "ISO-8859-1"""  I have no clue what this means, but it seems to get rid of the problem.)

\begin{Verbatim}
data = pd.read_csv("https://raw.githubusercontent.com/washingtonpost
/data-homicides/master/homicide-data.csv",encoding = "ISO-8859-1")
data["victim_age"] = pd.to_numeric(data["victim_age"],errors="coerce")
\end{Verbatim}
%
%the next hing I noticed is that the ages are not number, but strings
%I once again did a quick google search for "converting numpy columns to numbers" and learned I had to do the following
%\begin{Verbatim}
%\end{Verbatim}

\begin{enumerate}[label=(\alph*)]
\item  For each age $a = 1,\cdots,100$ determine the number of victims $n(a)$ with an age $<a$ and put these values in a list. You can ignore the effects of those entries with missing ages. 
\item Now think for a moment about what you expect a plot of $n(a) vs. a$ to look like, then make a plot of $n(a)$ vs. $a$. Does it look like as expected?
\item Break the data up into white and non-white victims and repeat part (a) for each group. Then, for each group, make the plot from part (a). Comment on what you find. 
\end{enumerate}
%You can break this data up into the entries where the victims is white and non-white with the code
%
%\begin{Verbatim}
%data_white = data[data.victim_race == "White"]
%data_notwhite = data[data.victim_race != "White"]
%\end{Verbatim}

\end{exercise}



%--------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Getting a sequence of wins]
Let $J$ denote a random variable representing the number of times a fair coin is flipped before two heads appear in a row. As we saw in class, the following code generates simulations of $J$:
\begin{Verbatim}
def flip_until_two():
  num_heads = 0
  total_flips = 0
  while num_heads <2:
    y = np.random.choice([0,1])
    if y == 0:
      num_heads = 0
    else:
      num_heads = num_heads + 1
    total_flips = total_flips + 1
  return total_flips
\end{Verbatim}

\begin{enumerate}[label=(\alph*)]
\item  By changing the code above, write a function rolluntil(n) that rolls a dice until we
get $n$ ones in a row. You should change the variable names accordingly. We will call this random variable \textcolor{orange}{$R_n$}.
%\item Derive a formula for $P(J=k)$. Hint: it is similar to the geometric distribution. 
\item  Make a DataFrame where each column represents a value of $n$ from $1$ to $6$ and each row is a simulation from the model  \textcolor{orange}{$R_n$}. There should be $100$ rows.
\item Make a plot of the maximum and minimum values of \textcolor{orange}{$R_n$} as a function of $n$ on the same plot. You might notice one of these increases much faster than the other.  
\end{enumerate}
\end{exercise}


%--------------------------------------------------------------------------------------------------------------------------------
%\begin{exercise}[The binomial distribution]
%Let $X_1,\dots,X_N$ be independent and identically distribution (abbreviated as iid) samples from a Bernoulli distribution with probability of success $q=1$. Consider the sum 
%\begin{equation}
%S_N = \sum_{i=1}^N X_i
%\end{equation}
%The variable $S_N$ is called a binomial random variable -- we can think of it as counting the number of ``successes'' in a sequence of $N$ trials which have a probability of success $p$. 
%The binomial distribution has the PMF
%\begin{equation}\label{eq:pdf-binomial}
%P(S_N = k) = {N \choose k}p^{k}(1-p)^{k-1}
%\end{equation}
%\begin{enumerate}[label=(\alph*)]
%\item What is the chance that $S_N = N$, what about $S_3 = 2$? (Hint: Write out all the outcomes) \label{ex:1a}
%\item Write a python function which generates samples of a Binomial distribution by filling in the code
%\begin{Verbatim}
%def my_binomial(N,q,n_samples):
%  y = np.zeros(n_samples)
%  for i in range(n_samples):
%    # fill in code here
%  return y
%\end{Verbatim}
%\item Using Monte Carlo simulations, test if your answers to \ref{ex:1a} are correct. 
%\item  Using Monte Carlo simulations, make a plot of $P(S_N= k)$ as a function of $k$ for $N=100$ and $N=1000$. Compare you simulations to Equation \ref{eq:pdf-binomial} by plotting both on the same plot. 
%\end{enumerate}
%Useful code can be found \href{https://colab.research.google.com/drive/1Gs-gSsUP1hHVwhrbwvWzLVm1ulcLJKRI#scrollTo=_c4br6SCUtUy}{here}
%%
%\end{exercise}



%
%\begin{exercise}
%\href{https://colab.research.google.com/drive/1Gs-gSsUP1hHVwhrbwvWzLVm1ulcLJKRI#scrollTo=69BY8z2IRXnU&line=6&uniqifier=1}{Verifying an analytical formula with simulations}
%\end{exercise}


%---------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Two gene model]
Consider the variant of the model discussed in class:
\begin{equation*}\label{eq:gene}
\Prob(Y_A,Y_B) = \left\{ \begin{array}{cc}
1/3 & \text{ if }Y_A=0 \text{ and } Y_B = 0\\
1/3 & \text{ if }Y_A=0 \text{ and } Y_B = 1\\
1/6 & \text{ if }Y_A=1 \text{ and } Y_B = 0\\
1/6 & \text{ if }Y_A=1 \text{ and } Y_B = 1\\
\end{array}
 \right.
\end{equation*}
\begin{enumerate}[label=(\alph*)]
\item What are the marginal distributions of $Y_A$ and $Y_B$?
\item Are $Y_A$ and $Y_B$ independent? 
\item Confirm you answer with simulations. 
\end{enumerate}
%Below I've generated monte carlo simulations from the gene model
%%. Let's pretend you don't know the parameter values (you could figure them out from my code). Supposing you didn't know whether $Y_A$ and $Y_B$ are independent, how would you determine this based on the data?
%\begin{Verbatim}
%yB = np.random.choice([0,1],10000)
%qs =  [yBi*0.3 + (1-yBi)*0.1 for yBi in yB]
%yA = [np.random.choice([0,1],p = [q,1-q]) for q in qs]
%data = np.transpose([yA,yB])
%df = pd.DataFrame(data,columns = ["yA","yB"])
%df
%\end{Verbatim}
%
%\begin{enumerate}[label=(\alph*)]
%\item Based on this code, can you write down a probability model for the variables $Y_A$ and $Y_B$? Are they independent? 
%\item Confirm you answer to the first part of this question using Monte Carlo simulations
%\end{enumerate}

%\href{https://colab.research.google.com/drive/1Gs-gSsUP1hHVwhrbwvWzLVm1ulcLJKRI#scrollTo=HT5mXESCXWYx}{Estimating conditional probability of dice}
\end{exercise}


%---------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Verifying variance formula for Bernoulli variable]
Verify the formula for the variance
\begin{equation*}
{\rm Var}(Y) = q(1-q)
\end{equation*}

Remember, you can do this you can use the fact that pointwise arithmetic between numpy arrays can be performed directly on the ways, e.g.
\begin{Verbatim}
q_range*q_range
\end{Verbatim}
makes a list where every element is the corresponding element of qrange squared. You should experiment to ensure you are using enough samples.
\end{exercise}

%---------------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Working with Washington Post Data]

This a continuation of Exercise \ref{ex:washpost}
Consider the quantities
\begin{align*}
&P(age <z)\\
&P(age <z|\text{white})\\
&P(age <z|\text{not white}).
\end{align*}
\begin{enumerate}[label=(\alph*)]
\item Explain who each of these are related to the plot you made in Exercise \ref{ex:washpost}. 
\item Make plots of them and comment of the difference between the plot in Exercise \ref{ex:washpost}. Do you think age and race are independent based on these plots. 
\item Using the data, approximate, 
\begin{equation*}
P(\text{white}| 10<age<60)
\end{equation*}
Hint: One way to do this is to use Bayes' rule 
\end{enumerate}

%\href{https://colab.research.google.com/drive/1Gs-gSsUP1hHVwhrbwvWzLVm1ulcLJKRI#scrollTo=vogWBcGHaZDM&line=3&uniqifier=1}{Working with homocide data}
\end{exercise}


%--------------------------------------------------------------------------------------------------------------------------------
\begin{exercise}[Covid modeling -- {\bf ungraded}]
Suppose we are interested in modeling how likely we are to contract covid after a night out. Imagine that you interact with $N$ people. Let $Y_i$ represent whether or not the $i$th person you interacted with has covid and $T_i$ represent whether or not you contract covid from the interaction with the $i$th person. 

Our model is as follows:
\begin{align*}
Y_i &\sim {\rm Bernoulli}(1/10)\\
T_i |(Y_i=1) &\sim {\rm Bernoulli}(1/2)\\
T_i|(Y_i=0) &\sim {\rm Bernoulli}(0)
\end{align*}

\begin{enumerate}[label=(\alph*)]
\item What is the distribution $T_i$ NOT conditioned on $Y_i$.  That is, what is the marginal distribution of $T_i$?
\item Fill in the question marks in the following function so that it simulates whether or not you got covid from the night out; that is, so it returns $1$ if you got covid and $0$ if you didn't.
\begin{Verbatim}
def sim_covid(n):
  got_covid = 0
  for k in range(n):
      got_covid_interaction = ????
      if got_covid_interaction ==1:
        got_covid =1
  return got_covid
\end{Verbatim}
\item  Confirm with Monte Carlo simulations simulations that the probability of getting covid form the entire night out is
\begin{equation}
P(\text{get covid}) = 1-\left(1-\frac{1}{20}\right)^n
\end{equation}
You should make a plot of this probability vs. $n$, similar to what we did for the Bernoulli distribution in the class notebook.
\end{enumerate}
%\href{https://colab.research.google.com/drive/1Gs-gSsUP1hHVwhrbwvWzLVm1ulcLJKRI#scrollTo=TnLORrmyBn6q&line=22&uniqifier=1}{Simulating covid}
\end{exercise}

\bibliographystyle{unsrt}
\bibliography{./../refs.bib}

\end{document}


\begin{exercise}{Simulating Binomial Random variables}
\begin{enumerate}[label=(\alph*)]
\item  Write a function that generates samples from a Binomial distribution by filling in the code below. 
\begin{Verbatim}
def my_binomial(N,q,n_samples):
  y = np.zeros(n_samples)
  for i in range(n_samples):
    # fill in code here
  return y
\end{Verbatim}
\item By running Monte carlo simulations and plotting histograms, compare the samples generated by this code to the sampled generated by the numpy function ``np.random.binomial`` (they should be the same). Along with the histograms, plot the probability distribution. You can use the following function 
\begin{Verbatim}
import scipy.special
def binomial_prob(y,N,q):
  return scipy.special.binom(N, y)*q**y*(1-q)**(N-y)
\end{Verbatim}
You should play around with $N$ and $q$, but only need to make one plot. 
The following code provides an example of how to compare two histograms:

\begin{Verbatim}
fig,ax = plt.subplots(figsize=(4,2))
# y1 and y2 are the two data sets you want to compare
ax.hist([y1,y2],label=["my function","numpy"],density=True)
ax.legend()
\end{Verbatim}
\end{enumerate}



 \bibliographystyle{unsrt}
\bibliography{./../refs.bib}


\end{exercise}